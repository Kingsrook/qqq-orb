description: >
  Unified publishing job for all branch types
  Handles version management, building, testing, and publishing based on branch type
  Supports: snapshot, release_candidate, release, and hotfix workflows

executor: localstack/default

parameters:
  branch_type:
    type: string
    default: "snapshot"
    description: "Branch type: snapshot, release_candidate, release, or hotfix"

steps:
  - checkout
  - node_install_dependencies
  - node_run_tests
  - node_manage_version
  - attach_workspace:
      at: .
  - node_build_package
  - node_publish
  - when:
      condition:
        or:
          - equal: ["snapshot", << parameters.branch_type >>]
          - equal: ["release_candidate", << parameters.branch_type >>]
      steps:
        - git_operations
